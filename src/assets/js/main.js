var scrambler = {


	///
	/// PROPERTY AND VALUE CREATION
	///

	// Value is lowest number used in ASCII printable characters range
	MIN_CHARCODE: 33,
	// Value is Highest number used in ASCII printable characters range
	MAX_CHARCODE: 126,

	//Value is the scramble link [styled to look as though button] within the document
    scrambleBtn: document.querySelector('#scramble'),
    //Value is the unscramble link [styled to look as though button] within the document
    unscrambleBtn: document.querySelector('#unscramble'),
    //Value is the textinput i.e textarea element within the document
    textInputEl: document.querySelector('#textInput'),
    //Value is the textDisplay element within the document
    textDisplayEl: document.querySelector('#textDisplay'),
    //Value is the scramble link [styled to look as though button] within the document
    clearBtn: document.querySelector('#clearBtn'),


    ///
	/// METHOD CREATION
	///

	scramble: function(str) {
        var result = '';
        // Function loops through characters and wraps them in a span tag with the hidden attribute
		for (var i = 0; i < str.length; i ++ ) {
			result += '<span hidden="">' + str.charAt(i) + '</span>';
			// randomNumber generates random number between 10 and 20
			var randomNumber = Math.floor(Math.random() * 10 + 10);
			// Second for loop inserts a random number of characters in between the hidden spans
			for (var n = 0; n <= randomNumber; n++) {
				// Characters are randomly generated via randomChar mathod and wrapped in a span tag with 
				result += '<span>' + this.randomChar() + '</span>';
			}
		}
		//Once the loop cycles through all the chracters and 'scrambles' them, the result is returned
        return result;
	},

	unscramble: function(str) {
		// Uses regular expressions to find all the '<span hidden="">' elements and capture what is inside the tags
		var result = str.match(/<span hidden="">(.*?)<\/span>/g).map(function(x) {
			// Clears all html tags
			return x.replace(/<[^>]*>/g, '');
			//Joins captured characters into a string without a separator
		}).join('');
        return result;
	},

	randomChar: function() {
		//Generetes random number from 33 - 126
		var charCode = Math.floor(Math.random() * (this.MAX_CHARCODE - this.MIN_CHARCODE) + this.MIN_CHARCODE);
		// Returns the character at the ASCII number generated via math in charCOde
		return String.fromCharCode(charCode);
	},


	/* Created for UI only and listed for encapsulation per instructions */
	buttonToggle: function() {
		var textValue = textInput.value;
		// Conditional Statement to check whether scramble or unscramble button is to be displayed
		if (textValue.indexOf('span')!=-1) {
			this.scrambleBtn.style.display = 'none';
			this.unscrambleBtn.style.display = 'inline-block';
		} else {
			this.scrambleBtn.style.display = 'inline-block';
			this.unscrambleBtn.style.display = 'none';
		}
	}
};

// Access buttonToggle method and execute function
scrambler.buttonToggle();

// On click of scrambleBtn, value of textInput and textDisplay replaced by value
// generated by scrambler method 
scrambler.scrambleBtn.addEventListener('click', function(e) {
    var scrambledText = scrambler.scramble(scrambler.textInputEl.value);
    scrambler.textDisplayEl.innerHTML = scrambler.textInputEl.value = scrambledText;
    scrambler.buttonToggle();
});

// On click of unscrambleBtn, value of textInput and textDisplay replaced by value
// generated by unscramble method 
scrambler.unscrambleBtn.addEventListener('click', function(e) {
    var unscrambledText = scrambler.unscramble(scrambler.textInputEl.value);
    scrambler.textDisplayEl.innerHTML = scrambler.textInputEl.value = unscrambledText;
    scrambler.buttonToggle();
});

// Clears text area to avoid manually clearing by user
scrambler.clearBtn.addEventListener('click', function(e) {
    scrambler.textDisplayEl.innerHTML = scrambler.textInputEl.value = '';
    scrambler.buttonToggle();
});

// Looks for changes in the textarea to assess which button should be displayed 
// For UI purposes
scrambler.textInputEl.addEventListener('keyup', function(e) {
	scrambler.buttonToggle();
});